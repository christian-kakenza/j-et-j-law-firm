<footer id="colophon" class="site-footer">
    <div class="top-footer">
        <div class="footer-overlay overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-sm-6">
                    <aside class="widget widget_text img-textwidget primary-bg">
                        <div class="footer-logo">
                            <a href="/">
                                <img src="/images/J&J logo white.svg" alt="J&J Law Firm Logo">
                            </a>
                        </div>
                        <div class="textwidget widget-text">
                            <%= __("footer.description") %>
                        </div>
                        <div class="footer-locate-link">
                            <ul>
                                <li>
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span class="locate-txt">
                                        <strong><%= __("footer.kinshasa") %> :</strong><br>
                                        <%= __("footer.kinshasa_address") %>
                                    </span>
                                </li>
                                <li>
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span class="locate-txt">
                                        <strong><%= __("footer.lubumbashi") %> :</strong><br>
                                        <%= __("footer.lubumbashi_address") %>
                                    </span>
                                </li>
                                <li>
                                    <a href="tel:+243995482416">
                                        <i class="fas fa-phone-alt"></i>
                                        <span class="locate-txt">
                                            <%= __("header.phone") %> (<%= __("footer.head_office") %>)
                                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a href="tel:+243810369919">
                                        <i class="fas fa-phone-alt"></i>
                                        <span class="locate-txt">
                                            +243 810 369 919 (<%= __("footer.branch_office") %>)
                                        </span>
                                    </a>
                                </li>
                                <li>
                                    <a href="mailto:lawfirmjetj@gmail.com">
                                        <i class="fas fa-envelope"></i>
                                        <span class="locate-txt">
                                            lawfirmjetj@gmail.com
                                        </span>
                                    </a>
                                </li>

                            </ul>
                        </div>
                    </aside>
                </div>
                <div class="col-lg-2 col-sm-6">
                    <aside class="widget">
                        <h5 class="widget-title"><%= __("footer.navigation") %></h5>
                        <ul class="widget-underline">
                            <li>
                                <a href="/"><%= __("header.home") %></a>
                            </li>
                            <li>
                                <a href="/about"><%= __("header.about") %></a>
                            </li>
                            <li>
                                <a href="/practice-area"><%= __("services.all_services") %></a>
                            </li>
                            <li>
                                <a href="/attorney"><%= __("team.our_team") %></a>
                            </li>
                            <li>
                                <a href="/contact"><%= __("header.contact") %></a>
                            </li>
                            <li>
                                <a href="/faq"><%= __("header.faq") %></a>
                            </li>
                        </ul>
                    </aside>
                </div>
                <div class="col-lg-2 col-sm-6">
                    <aside class="widget">
                        <h5 class="widget-title"><%= __("footer.key_services") %></h5>
                        <ul>
                            <li>
                                <a href="/practice-area-mines"><%= __("services.mining") %></a>
                            </li>
                            <li>
                                <a href="/practice-area-ohada"><%= __("services.ohada") %></a>
                            </li>
                            <li>
                                <a href="/practice-area-assurances"><%= __("services.insurance") %></a>
                            </li>
                            <li>
                                <a href="/practice-area-immobilier"><%= __("services.real_estate") %></a>
                            </li>
                            <li>
                                <a href="/practice-area-corporatif"><%= __("services.agricultural") %></a>
                            </li>
                            <li>
                                <a href="/practice-area-droits-homme"><%= __("services.family") %></a>
                            </li>
                        </ul>
                    </aside>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <aside class="widget news-widget">
                        <h5 class="widget-title"><%= __("footer.newsletter") %></h5>
                        <div class="textwidget widget-text">
                            <%= __("footer.newsletter_desc") %>
                        </div>
                        
                        <!-- Message de confirmation -->
                        <div id="newsletter-message" style="display: none; background: #d4edda; color: #155724; padding: 10px; border-radius: 5px; margin-bottom: 15px; border-left: 4px solid #28a745;">
                            <i class="fas fa-check-circle"></i> <span id="newsletter-message-text"></span>
                        </div>
                        
                        <!-- Formulaire newsletter -->
                        <form class="footer-email-form" id="newsletter-form">
                            <div class="input-group">
                                <input type="email" name="email" placeholder="<%= __("footer.email_placeholder") %>" required>
                                <button type="submit" class="footer-email-btn" title="<%= __("footer.subscribe") %>">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </form>
                        


                        <!-- RÃ©seaux sociaux -->
                        <div class="footer-social-links">
                            <p><%= __("footer.follow_us") %> :</p>
                            <ul>
                                <li>
                                    <a href="https://www.facebook.com/" target="_blank" rel="noopener noreferrer" title="Facebook">
                                        <i class="fab fa-facebook-f"></i>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://twitter.com/" target="_blank" rel="noopener noreferrer" title="Twitter">
                                        <i class="fab fa-twitter"></i>
                                    </a>
                                </li>

                                <li>
                                    <a href="https://www.instagram.com/" target="_blank" rel="noopener noreferrer" title="Instagram">
                                        <i class="fab fa-instagram"></i>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://wa.me/243995482416" target="_blank" rel="noopener noreferrer" title="WhatsApp">
                                        <i class="fab fa-whatsapp"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>


                    </aside>
                </div>
            </div>
        </div>
    </div>
    <div class="bottom-footer">
        <div class="container">
            <div class="copy-right">
                <%- __("footer.copyright_full") %> <%= new Date().getFullYear() %> <strong>J&J LAW FIRM</strong>. 
                <%= __("footer.all_rights_reserved") %>
            </div>
        </div>
    </div>
</footer>

<!-- Bouton retour en haut -->
<a id="backTotop" href="#" class="to-top-icon" title="<%= __("footer.back_to_top") %>">
    <i class="fas fa-chevron-up"></i>
</a>

<!-- Formulaire de recherche (optionnel) -->
<div class="header-search-form" style="display: none;">
    <div class="container">
        <div class="header-search-container">
            <form class="search-form" role="search" method="get">
                <input type="text" name="s" placeholder="<%= __("footer.search_placeholder") %>">
                <button type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </form>
            <a href="#" class="search-close">
                <i class="fas fa-times"></i>
            </a>
        </div>
    </div>
</div>

<!-- Scripts JavaScript -->
<script src="/vendors/jquery/jquery.js"></script>
<script src="/vendors/waypoint/jquery.waypoints.min.js"></script>
<script src="/vendors/bootstrap/js/bootstrap.min.js"></script>
<script src="/vendors/jquery-ui/jquery-ui.min.js"></script>
<script src="/vendors/progressbar-fill-visible/js/progressBar.min.js"></script>
<script src="/vendors/circle-progress/circle-progress.min.js"></script>
<script src="/vendors/countdown-date-loop-counter/loopcounter.js"></script>
<script src="/vendors/counterup/jquery.counterup.js"></script>
<script src="/vendors/modal-video/jquery-modal-video.min.js"></script>
<script src="/vendors/masonry/masonry.pkgd.min.js"></script>
<script src="/vendors/isotope/isotope.pkgd.min.js"></script>
<script src="/vendors/fancybox/dist/jquery.fancybox.min.js"></script>
<script src="/vendors/slick/slick.min.js"></script>
<script src="/vendors/slick-nav/jquery.slicknav.js"></script>
<script src="/js/custom.js"></script>

<!-- ============ SCRIPT UNIFIÃ‰ DE GESTION DE LANGUE AVEC COOKIES PERSISTANTS ============ -->
<script>
    (function() {
        'use strict';
        
        // ========== 1. DÃ‰TECTION DE LA LANGUE ACTUELLE ==========
        // Utiliser locale depuis le serveur (correct)
        const currentLocale = '<%= locale %>' || 'fr';
        
        // ========== 2. FONCTION PRINCIPALE DE CHANGEMENT DE LANGUE ==========
        window.setLanguage = function(lang) {
            // Validation
            if (!['fr', 'en'].includes(lang)) {
                console.error('Langue non supportÃ©e:', lang);
                return false;
            }
            
            // Sauvegarder dans le cookie VIA LE SERVEUR (mÃ©thode fiable)
            fetch('/set-language/' + lang, {
                method: 'GET',
                credentials: 'same-origin' // Important pour les cookies
            })
            .then(response => {
                if (response.ok) {
                    console.log('âœ… Langue changÃ©e pour:', lang);
                    
                    // Sauvegarder aussi dans localStorage comme backup
                    try {
                        localStorage.setItem('preferred-language', lang);
                    } catch(e) {
                        console.warn('localStorage non disponible');
                    }
                    
                    // Recharger la page pour appliquer la nouvelle langue
                    window.location.reload();
                } else {
                    console.error('âŒ Erreur serveur:', response.status);
                    // Fallback: redirection avec paramÃ¨tre URL
                    window.location.href = window.location.pathname + '?lang=' + lang;
                }
            })
            .catch(error => {
                console.error('âŒ Erreur rÃ©seau:', error);
                // Fallback: redirection avec paramÃ¨tre URL
                window.location.href = window.location.pathname + '?lang=' + lang;
            });
            
            return false;
        };
        
        // ========== 3. SÃ‰LECTEUR DE LANGUE DROPDOWN ==========
        function initLanguageSelector() {
            const languageBtn = document.querySelector('.language-btn');
            const languageDropdown = document.querySelector('.language-dropdown');
            
            if (languageBtn && languageDropdown) {
                // Supprimer les anciens event listeners
                const newBtn = languageBtn.cloneNode(true);
                languageBtn.parentNode.replaceChild(newBtn, languageBtn);
                const newDropdown = languageDropdown.cloneNode(true);
                languageDropdown.parentNode.replaceChild(newDropdown, languageDropdown);
                
                // RÃ©attacher les Ã©vÃ©nements
                const finalBtn = document.querySelector('.language-btn');
                const finalDropdown = document.querySelector('.language-dropdown');
                
                if (finalBtn && finalDropdown) {
                    finalBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        const isVisible = finalDropdown.style.display === 'block';
                        finalDropdown.style.display = isVisible ? 'none' : 'block';
                    });
                    
                    document.addEventListener('click', function() {
                        if (finalDropdown) {
                            finalDropdown.style.display = 'none';
                        }
                    });
                    
                    finalDropdown.addEventListener('click', function(e) {
                        e.stopPropagation();
                    });
                    
                    // Mettre Ã  jour le texte du bouton selon la langue active
                    const btnText = finalBtn.querySelector('span');
                    if (btnText) {
                        const langNames = {
                            fr: 'FRANÃ‡AIS',
                            en: 'ENGLISH'
                        };
                        btnText.textContent = langNames[currentLocale] || 'FRANÃ‡AIS';
                    }
                }
            }
        }
        
        // ========== 4. NEWSLETTER MULTILINGUE ==========
        function initNewsletter() {
            const newsletterForm = document.getElementById('newsletter-form');
            if (!newsletterForm) return;
            
            // Supprimer ancien listener
            const newForm = newsletterForm.cloneNode(true);
            newsletterForm.parentNode.replaceChild(newForm, newsletterForm);
            
            // Ajouter nouveau listener
            const finalForm = document.getElementById('newsletter-form');
            
            finalForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const emailInput = this.querySelector('input[name="email"]');
                const email = emailInput ? emailInput.value : '';
                const messageDiv = document.getElementById('newsletter-message');
                const messageText = document.getElementById('newsletter-message-text');
                
                if (!messageDiv || !messageText) return;
                
                // Messages multilingues
                const messages = {
                    fr: {
                        error: 'Veuillez entrer une adresse email valide.',
                        success: 'Merci ! Vous Ãªtes maintenant inscrit Ã  notre newsletter.'
                    },
                    en: {
                        error: 'Please enter a valid email address.',
                        success: 'Thank you! You are now subscribed to our newsletter.'
                    }
                };
                
                // Validation email
                if (!email || !email.includes('@') || !email.includes('.')) {
                    messageText.innerHTML = messages[currentLocale]?.error || messages.fr.error;
                    messageDiv.style.background = '#f8d7da';
                    messageDiv.style.color = '#721c24';
                    messageDiv.style.borderLeftColor = '#dc3545';
                    messageDiv.style.display = 'block';
                    return;
                }
                
                // Simulation succÃ¨s
                messageText.innerHTML = messages[currentLocale]?.success || messages.fr.success;
                messageDiv.style.background = '#d4edda';
                messageDiv.style.color = '#155724';
                messageDiv.style.borderLeftColor = '#28a745';
                messageDiv.style.display = 'block';
                
                // Reset form
                emailInput.value = '';
                
                // Masquer aprÃ¨s 5 secondes
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 5000);
                
                console.log('ðŸ“§ Newsletter inscription:', email, 'Langue:', currentLocale);
            });
        }
        
        // ========== 5. BOUTON RETOUR EN HAUT ==========
        function initBackToTop() {
            const backToTop = document.getElementById('backTotop');
            if (!backToTop) return;
            
            // GÃ©rer l'affichage au scroll
            $(window).scroll(function() {
                if ($(this).scrollTop() > 100) {
                    $('#backTotop').fadeIn();
                } else {
                    $('#backTotop').fadeOut();
                }
            });
            
            // GÃ©rer le click
            $('#backTotop').click(function(e) {
                e.preventDefault();
                $('html, body').animate({ scrollTop: 0 }, 600);
                return false;
            });
            
            // Mettre Ã  jour le titre selon la langue
            const titles = {
                fr: 'Retour en haut',
                en: 'Back to top'
            };
            backToTop.setAttribute('title', titles[currentLocale] || titles.fr);
        }
        
        // ========== 6. INITIALISATION AU CHARGEMENT ==========
        document.addEventListener('DOMContentLoaded', function() {
            initLanguageSelector();
            initNewsletter();
            initBackToTop();
            
            console.log('ðŸŒ Langue active:', currentLocale, '(persistante sur toutes les pages)');
        });
        
        // ========== 7. SYNC AVEC LOCALSTORAGE AU CHARGEMENT ==========
        try {
            const savedLang = localStorage.getItem('preferred-language');
            if (savedLang && savedLang !== currentLocale) {
                console.log('ðŸ”„ Synchronisation localStorage -> cookie:', savedLang);
                // Silencieusement synchroniser
                fetch('/set-language/' + savedLang, { 
                    method: 'GET', 
                    credentials: 'same-origin' 
                }).catch(() => {});
            }
        } catch(e) {
            // Ignorer erreurs localStorage
        }
        
    })();
</script>

<!-- ============ CORRECTION DU HTML LANG DANS LE HEADER ============ -->

<script>
    // Correction pour le header : Ã  dÃ©placer dans le fichier header
    // Remplacer : <html lang="<%= __("locale") || 'fr' %>">
    // Par :        <html lang="<%= locale || 'fr' %>">
    // 
    // le header, ce script ajuste automatiquement
    document.documentElement.lang = '<%= locale || "fr" %>';
</script>

</body>

</html>
